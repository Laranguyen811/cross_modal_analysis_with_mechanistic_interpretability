
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.0001, num_epochs=100, batch_size=64, warmup_steps=10, weight_decay=0.0, device='cuda', seed=0, optimizer_name='AdamW'), logging=LoggingConfig(log_dir='logs', log_frequency=10, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7f5fb92e2350>)
  0%|                                                                                                                                                                                                                                                                         | 0/100 [00:00<?, ?it/s]

0it [00:05, ?it/s]

10it [00:06,  2.51it/s]
  1%|██▌                                                                                                                                                                                                                                                              | 1/100 [00:09<15:05,  9.14s/it]
0it [00:00, ?it/s]
Steps20 | Train loss: 1.800 | Train acc: 0.018 | Test loss: 3.452 | Test acc: 0.000

8it [00:01,  7.69it/s]
  2%|█████▏                                                                                                                                                                                                                                                           | 2/100 [00:13<09:52,  6.04s/it]
0it [00:00, ?it/s]
Steps50 | Train loss: 0.711 | Train acc: 0.020 | Test loss: 1.214 | Test acc: 0.000

Steps60 | Train loss: 0.602 | Train acc: 0.013 | Test loss: 1.135 | Test acc: 0.000
28it [00:03,  7.10it/s]                                                                                                                                                                                                                                               | 2/100 [00:16<09:52,  6.04s/it]
  3%|███████▋                                                                                                                                                                                                                                                         | 3/100 [00:16<08:13,  5.08s/it]
5it [00:00, 40.23it/s]
Steps80 | Train loss: 0.608 | Train acc: 0.018 | Test loss: 1.127 | Test acc: 0.028

15it [00:01, 10.63it/s]
  4%|██████████▎                                                                                                                                                                                                                                                      | 4/100 [00:20<07:23,  4.62s/it]
4it [00:00, 39.65it/s]
Steps110 | Train loss: 0.426 | Train acc: 0.014 | Test loss: 0.747 | Test acc: 0.028

19it [00:02,  6.44it/s]
  5%|████████████▊                                                                                                                                                                                                                                                    | 5/100 [00:24<06:18,  3.98s/it]
6it [00:01,  6.34it/s]
Steps140 | Train loss: 0.293 | Train acc: 0.017 | Test loss: 0.570 | Test acc: 0.056

16it [00:02,  8.06it/s]
  6%|███████████████▍                                                                                                                                                                                                                                                 | 6/100 [00:28<06:12,  3.96s/it]
11it [00:01, 11.19it/s]
Steps170 | Train loss: 0.256 | Train acc: 0.018 | Test loss: 0.497 | Test acc: 0.028

27it [00:03,  7.78it/s]
  7%|█████████████████▉                                                                                                                                                                                                                                               | 7/100 [00:32<06:07,  3.95s/it]
10it [00:01,  8.84it/s]
Steps200 | Train loss: 0.223 | Train acc: 0.019 | Test loss: 0.465 | Test acc: 0.000
  8%|████████████████████▌                                                                                                                                                                                                                                            | 8/100 [00:35<06:01,  3.93s/it]
0it [00:00, ?it/s]
Steps220 | Train loss: 0.212 | Train acc: 0.020 | Test loss: 0.408 | Test acc: 0.000

15it [00:01, 10.77it/s]
  9%|███████████████████████▏                                                                                                                                                                                                                                         | 9/100 [00:39<05:56,  3.92s/it]
5it [00:00, 40.32it/s]
Steps250 | Train loss: 0.205 | Train acc: 0.017 | Test loss: 0.371 | Test acc: 0.000

15it [00:01, 10.77it/s]
 10%|█████████████████████████▌                                                                                                                                                                                                                                      | 10/100 [00:43<05:21,  3.57s/it]
6it [00:01,  6.45it/s]
Steps280 | Train loss: 0.184 | Train acc: 0.017 | Test loss: 0.347 | Test acc: 0.000

16it [00:02,  8.10it/s]
 11%|████████████████████████████▏                                                                                                                                                                                                                                   | 11/100 [00:47<05:26,  3.67s/it]
8it [00:01,  7.68it/s]
Steps310 | Train loss: 0.186 | Train acc: 0.020 | Test loss: 0.353 | Test acc: 0.000

18it [00:02,  8.51it/s]
 12%|██████████████████████████████▋                                                                                                                                                                                                                                 | 12/100 [00:51<05:28,  3.73s/it]
10it [00:01,  8.93it/s]
Steps340 | Train loss: 0.175 | Train acc: 0.016 | Test loss: 0.367 | Test acc: 0.000

20it [00:02,  8.88it/s]
 13%|█████████████████████████████████▎                                                                                                                                                                                                                              | 13/100 [00:54<05:28,  3.77s/it]
15it [00:01, 10.83it/s]
Steps370 | Train loss: 0.159 | Train acc: 0.019 | Test loss: 0.337 | Test acc: 0.028

23it [00:02,  8.82it/s]
 14%|███████████████████████████████████▊                                                                                                                                                                                                                            | 14/100 [00:58<05:26,  3.80s/it]
15it [00:01, 10.76it/s]
Steps400 | Train loss: 0.165 | Train acc: 0.018 | Test loss: 0.344 | Test acc: 0.028
 15%|██████████████████████████████████████▍                                                                                                                                                                                                                         | 15/100 [01:01<04:57,  3.50s/it]
5it [00:01,  5.42it/s]

19it [00:02,  9.17it/s]
Steps430 | Train loss: 0.145 | Train acc: 0.021 | Test loss: 0.295 | Test acc: 0.000
 16%|████████████████████████████████████████▉                                                                                                                                                                                                                       | 16/100 [01:05<05:03,  3.61s/it]
8it [00:01,  7.76it/s]
Steps450 | Train loss: 0.146 | Train acc: 0.022 | Test loss: 0.306 | Test acc: 0.000

18it [00:02,  8.61it/s]
 17%|███████████████████████████████████████████▌                                                                                                                                                                                                                    | 17/100 [01:09<05:05,  3.68s/it]
13it [00:01,  9.95it/s]
Steps480 | Train loss: 0.140 | Train acc: 0.014 | Test loss: 0.298 | Test acc: 0.000

21it [00:02,  8.49it/s]
 18%|██████████████████████████████████████████████                                                                                                                                                                                                                  | 18/100 [01:13<05:06,  3.73s/it]
15it [00:01, 10.83it/s]
Steps510 | Train loss: 0.136 | Train acc: 0.016 | Test loss: 0.306 | Test acc: 0.000

23it [00:02,  8.78it/s]
 19%|████████████████████████████████████████████████▋                                                                                                                                                                                                               | 19/100 [01:17<05:05,  3.78s/it]
18it [00:01, 12.78it/s]
 20%|███████████████████████████████████████████████████▏                                                                                                                                                                                                            | 20/100 [01:18<04:39,  3.49s/it]
0it [00:00, ?it/s]
Steps550 | Train loss: 0.127 | Train acc: 0.021 | Test loss: 0.281 | Test acc: 0.000

16it [00:02,  8.16it/s]
 21%|█████████████████████████████████████████████████████▊                                                                                                                                                                                                          | 21/100 [01:23<04:44,  3.60s/it]
3it [00:01,  2.62it/s]
Steps580 | Train loss: 0.129 | Train acc: 0.020 | Test loss: 0.288 | Test acc: 0.000

18it [00:02,  8.53it/s]
 22%|████████████████████████████████████████████████████████▎                                                                                                                                                                                                       | 22/100 [01:27<04:47,  3.68s/it]
5it [00:01,  4.22it/s]
Steps610 | Train loss: 0.126 | Train acc: 0.018 | Test loss: 0.275 | Test acc: 0.000

20it [00:02,  8.92it/s]
Steps630 | Train loss: 0.124 | Train acc: 0.016 | Test loss: 0.285 | Test acc: 0.000
 23%|██████████████████████████████████████████████████████████▉                                                                                                                                                                                                     | 23/100 [01:31<04:47,  3.73s/it]
15it [00:01, 10.82it/s]

23it [00:02,  8.81it/s]
Steps660 | Train loss: 0.123 | Train acc: 0.021 | Test loss: 0.270 | Test acc: 0.028
 24%|█████████████████████████████████████████████████████████████▍                                                                                                                                                                                                  | 24/100 [01:35<04:46,  3.77s/it]
15it [00:01, 10.75it/s]
 25%|████████████████████████████████████████████████████████████████                                                                                                                                                                                                | 25/100 [01:36<04:21,  3.49s/it]
0it [00:00, ?it/s]
Steps690 | Train loss: 0.118 | Train acc: 0.024 | Test loss: 0.267 | Test acc: 0.000

19it [00:02, 10.28it/s]
 26%|██████████████████████████████████████████████████████████████████▌                                                                                                                                                                                             | 26/100 [01:40<04:28,  3.63s/it]
0it [00:00, ?it/s]
Steps720 | Train loss: 0.110 | Train acc: 0.021 | Test loss: 0.263 | Test acc: 0.000

21it [00:02,  9.43it/s]
 27%|█████████████████████████████████████████████████████████████████████                                                                                                                                                                                           | 27/100 [01:44<04:30,  3.71s/it]
0it [00:00, ?it/s]
Steps750 | Train loss: 0.131 | Train acc: 0.018 | Test loss: 0.294 | Test acc: 0.000

23it [00:02,  9.68it/s]
 28%|███████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                        | 28/100 [01:48<04:30,  3.76s/it]
5it [00:00, 40.48it/s]
Steps780 | Train loss: 0.130 | Train acc: 0.017 | Test loss: 0.281 | Test acc: 0.000

22it [00:02,  8.29it/s]
 29%|██████████████████████████████████████████████████████████████████████████▏                                                                                                                                                                                     | 29/100 [01:52<04:28,  3.79s/it]
4it [00:00, 39.18it/s]
Steps810 | Train loss: 0.112 | Train acc: 0.022 | Test loss: 0.255 | Test acc: 0.000
 30%|████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                   | 30/100 [01:55<04:05,  3.50s/it]
0it [00:00, ?it/s]

6it [00:02,  6.37it/s]
Steps840 | Train loss: 0.119 | Train acc: 0.021 | Test loss: 0.268 | Test acc: 0.000
 31%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                | 31/100 [01:59<04:09,  3.62s/it]
0it [00:00, ?it/s]

13it [00:02,  5.41it/s]
Steps870 | Train loss: 0.118 | Train acc: 0.021 | Test loss: 0.267 | Test acc: 0.000
 32%|█████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                                              | 32/100 [02:03<04:11,  3.70s/it]
0it [00:00, ?it/s]

20it [00:02,  8.87it/s]
Steps900 | Train loss: 0.120 | Train acc: 0.021 | Test loss: 0.256 | Test acc: 0.028
 33%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                                           | 33/100 [02:07<04:11,  3.76s/it]
5it [00:00, 40.21it/s]
Steps920 | Train loss: 0.110 | Train acc: 0.021 | Test loss: 0.249 | Test acc: 0.000

23it [00:02,  8.73it/s]
 34%|███████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                         | 34/100 [02:10<04:10,  3.80s/it]
5it [00:00, 41.02it/s]
Steps950 | Train loss: 0.101 | Train acc: 0.022 | Test loss: 0.234 | Test acc: 0.000
 35%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                      | 35/100 [02:13<03:47,  3.50s/it]
0it [00:00, ?it/s]

6it [00:01,  6.39it/s]
Steps980 | Train loss: 0.099 | Train acc: 0.027 | Test loss: 0.243 | Test acc: 0.028
 36%|████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                                   | 36/100 [02:17<03:52,  3.63s/it]
0it [00:00, ?it/s]

8it [00:01,  7.66it/s]
Steps1010 | Train loss: 0.107 | Train acc: 0.025 | Test loss: 0.253 | Test acc: 0.028
 37%|██████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                 | 37/100 [02:21<03:53,  3.70s/it]
0it [00:00, ?it/s]

10it [00:01,  8.99it/s]
Steps1040 | Train loss: 0.099 | Train acc: 0.026 | Test loss: 0.232 | Test acc: 0.028
 38%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                              | 38/100 [02:25<03:52,  3.75s/it]
5it [00:00, 40.29it/s]

15it [00:01, 10.75it/s]
Steps1070 | Train loss: 0.096 | Train acc: 0.027 | Test loss: 0.235 | Test acc: 0.028
 39%|███████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                            | 39/100 [02:29<03:50,  3.79s/it]
5it [00:00, 40.28it/s]

19it [00:02,  6.18it/s]
Steps1100 | Train loss: 0.093 | Train acc: 0.029 | Test loss: 0.234 | Test acc: 0.000
 40%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                         | 40/100 [02:33<03:29,  3.50s/it]
6it [00:01,  6.39it/s]

21it [00:03,  5.95it/s]
Steps1130 | Train loss: 0.092 | Train acc: 0.031 | Test loss: 0.223 | Test acc: 0.028
 41%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                       | 41/100 [02:37<03:33,  3.61s/it]
8it [00:01,  7.69it/s]
 42%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                    | 42/100 [02:39<03:33,  3.69s/it]
0it [00:00, ?it/s]
Steps1160 | Train loss: 0.090 | Train acc: 0.035 | Test loss: 0.224 | Test acc: 0.000

10it [00:01,  8.95it/s]
Steps1180 | Train loss: 0.091 | Train acc: 0.025 | Test loss: 0.223 | Test acc: 0.000
 43%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                  | 43/100 [02:43<03:33,  3.74s/it]
5it [00:00, 40.53it/s]

15it [00:01, 10.76it/s]
Steps1210 | Train loss: 0.096 | Train acc: 0.037 | Test loss: 0.234 | Test acc: 0.000
 44%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                               | 44/100 [02:47<03:31,  3.79s/it]
5it [00:00, 40.56it/s]

15it [00:01, 10.72it/s]
Steps1240 | Train loss: 0.097 | Train acc: 0.029 | Test loss: 0.228 | Test acc: 0.000
 45%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                            | 45/100 [02:51<03:12,  3.50s/it]
6it [00:01,  6.45it/s]

16it [00:02,  8.14it/s]
Steps1270 | Train loss: 0.089 | Train acc: 0.032 | Test loss: 0.220 | Test acc: 0.056
 46%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                          | 46/100 [02:55<03:14,  3.61s/it]
8it [00:01,  7.67it/s]

18it [00:02,  8.48it/s]
Steps1300 | Train loss: 0.092 | Train acc: 0.028 | Test loss: 0.223 | Test acc: 0.000
 47%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                       | 47/100 [02:59<03:15,  3.69s/it]
10it [00:01,  8.93it/s]

25it [00:03,  6.34it/s]
Steps1330 | Train loss: 0.087 | Train acc: 0.037 | Test loss: 0.214 | Test acc: 0.056
 48%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                     | 48/100 [03:03<03:14,  3.74s/it]
15it [00:01, 10.69it/s]
 49%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                  | 49/100 [03:05<03:13,  3.79s/it]
0it [00:00, ?it/s]
Steps1360 | Train loss: 0.082 | Train acc: 0.037 | Test loss: 0.215 | Test acc: 0.028

15it [00:01, 10.72it/s]
 50%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                | 50/100 [03:09<02:54,  3.49s/it]
6it [00:01,  6.41it/s]
Steps1390 | Train loss: 0.087 | Train acc: 0.044 | Test loss: 0.220 | Test acc: 0.000

16it [00:02,  8.12it/s]
 51%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                             | 51/100 [03:13<02:56,  3.61s/it]
8it [00:01,  7.74it/s]
Steps1420 | Train loss: 0.084 | Train acc: 0.036 | Test loss: 0.212 | Test acc: 0.000

18it [00:02,  8.55it/s]
Steps1440 | Train loss: 0.095 | Train acc: 0.029 | Test loss: 0.233 | Test acc: 0.028
 52%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                           | 52/100 [03:17<02:56,  3.68s/it]
10it [00:01,  8.93it/s]

20it [00:02,  8.87it/s]
Steps1470 | Train loss: 0.088 | Train acc: 0.037 | Test loss: 0.216 | Test acc: 0.000
 53%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                        | 53/100 [03:21<02:55,  3.74s/it]
15it [00:01, 10.77it/s]

23it [00:02,  8.82it/s]
Steps1500 | Train loss: 0.103 | Train acc: 0.029 | Test loss: 0.260 | Test acc: 0.000
 54%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                     | 54/100 [03:25<02:53,  3.77s/it]
15it [00:01, 10.70it/s]
 55%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                   | 55/100 [03:28<02:36,  3.49s/it]
1it [00:01,  1.07s/it]
Steps1530 | Train loss: 0.085 | Train acc: 0.038 | Test loss: 0.213 | Test acc: 0.000

16it [00:02,  8.14it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 56/100 [03:32<02:38,  3.60s/it]
3it [00:01,  2.61it/s]
Steps1560 | Train loss: 0.082 | Train acc: 0.044 | Test loss: 0.213 | Test acc: 0.000

18it [00:02,  8.44it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                              | 57/100 [03:35<02:38,  3.69s/it]
10it [00:01,  8.89it/s]
Steps1590 | Train loss: 0.084 | Train acc: 0.044 | Test loss: 0.213 | Test acc: 0.000

20it [00:02,  8.86it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                           | 58/100 [03:39<02:37,  3.75s/it]
15it [00:01, 10.83it/s]
Steps1620 | Train loss: 0.081 | Train acc: 0.044 | Test loss: 0.219 | Test acc: 0.000

23it [00:02,  8.80it/s]
 59%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                         | 59/100 [03:43<02:34,  3.78s/it]
15it [00:01, 10.83it/s]
Steps1650 | Train loss: 0.082 | Train acc: 0.040 | Test loss: 0.226 | Test acc: 0.000
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                      | 60/100 [03:45<02:19,  3.49s/it]
0it [00:00, ?it/s]
Steps1670 | Train loss: 0.085 | Train acc: 0.043 | Test loss: 0.219 | Test acc: 0.000

16it [00:02,  8.11it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 61/100 [03:49<02:20,  3.61s/it]
0it [00:00, ?it/s]
Steps1700 | Train loss: 0.079 | Train acc: 0.053 | Test loss: 0.216 | Test acc: 0.028

18it [00:02,  8.53it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                 | 62/100 [03:53<02:20,  3.69s/it]
0it [00:00, ?it/s]
Steps1730 | Train loss: 0.076 | Train acc: 0.051 | Test loss: 0.207 | Test acc: 0.000

20it [00:02,  8.87it/s]
 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                              | 63/100 [03:58<02:18,  3.74s/it]
5it [00:01, 40.69it/s]
Steps1760 | Train loss: 0.079 | Train acc: 0.051 | Test loss: 0.212 | Test acc: 0.000

23it [00:02,  8.81it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                            | 64/100 [04:02<02:16,  3.78s/it]
10it [00:01,  6.61it/s]
Steps1790 | Train loss: 0.076 | Train acc: 0.049 | Test loss: 0.203 | Test acc: 0.028
 65%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                         | 65/100 [04:03<02:02,  3.49s/it]
0it [00:00, ?it/s]

14it [00:02,  5.73it/s]
Steps1820 | Train loss: 0.089 | Train acc: 0.040 | Test loss: 0.223 | Test acc: 0.000
 66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                       | 66/100 [04:07<02:02,  3.61s/it]
0it [00:00, ?it/s]

22it [00:02, 11.66it/s]
Steps1850 | Train loss: 0.085 | Train acc: 0.047 | Test loss: 0.218 | Test acc: 0.028
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                    | 67/100 [04:11<02:01,  3.69s/it]
0it [00:00, ?it/s]

20it [00:02,  8.95it/s]
Steps1880 | Train loss: 0.082 | Train acc: 0.043 | Test loss: 0.204 | Test acc: 0.028
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                  | 68/100 [04:15<01:59,  3.74s/it]
5it [00:00, 40.48it/s]
Steps1900 | Train loss: 0.078 | Train acc: 0.046 | Test loss: 0.213 | Test acc: 0.056

23it [00:02,  8.75it/s]
 69%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 69/100 [04:19<01:57,  3.78s/it]
5it [00:00, 40.67it/s]
Steps1930 | Train loss: 0.075 | Train acc: 0.055 | Test loss: 0.207 | Test acc: 0.000
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                            | 70/100 [04:21<01:44,  3.48s/it]
0it [00:00, ?it/s]

6it [00:01,  6.46it/s]
Steps1960 | Train loss: 0.080 | Train acc: 0.050 | Test loss: 0.209 | Test acc: 0.000
 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                          | 71/100 [04:25<01:44,  3.60s/it]
0it [00:00, ?it/s]

13it [00:02,  5.46it/s]
Steps1990 | Train loss: 0.078 | Train acc: 0.057 | Test loss: 0.206 | Test acc: 0.000
 72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                       | 72/100 [04:29<01:42,  3.68s/it]
0it [00:00, ?it/s]

20it [00:02,  8.94it/s]
Steps2020 | Train loss: 0.076 | Train acc: 0.055 | Test loss: 0.207 | Test acc: 0.028
 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                     | 73/100 [04:33<01:40,  3.73s/it]
5it [00:00, 40.75it/s]

23it [00:02,  8.82it/s]
Steps2050 | Train loss: 0.082 | Train acc: 0.050 | Test loss: 0.221 | Test acc: 0.000
 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                  | 74/100 [04:37<01:38,  3.77s/it]
5it [00:00, 40.25it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                | 75/100 [04:40<01:26,  3.48s/it]
0it [00:00, ?it/s]
Steps2080 | Train loss: 0.075 | Train acc: 0.057 | Test loss: 0.199 | Test acc: 0.000

10it [00:01, 10.92it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                             | 76/100 [04:44<01:26,  3.60s/it]
0it [00:00, ?it/s]
Steps2110 | Train loss: 0.079 | Train acc: 0.056 | Test loss: 0.215 | Test acc: 0.028

12it [00:01, 12.08it/s]
Steps2130 | Train loss: 0.081 | Train acc: 0.059 | Test loss: 0.194 | Test acc: 0.000
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                           | 77/100 [04:47<01:24,  3.68s/it]
4it [00:00, 39.78it/s]

13it [00:01,  9.79it/s]
Steps2160 | Train loss: 0.085 | Train acc: 0.052 | Test loss: 0.226 | Test acc: 0.000
 78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 78/100 [04:51<01:22,  3.74s/it]
5it [00:00, 40.08it/s]

15it [00:01, 10.68it/s]
Steps2190 | Train loss: 0.080 | Train acc: 0.058 | Test loss: 0.207 | Test acc: 0.028
 79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 79/100 [04:55<01:19,  3.79s/it]
5it [00:00, 40.49it/s]
 79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 79/100 [04:56<01:18,  3.76s/it]
Traceback (most recent call last):
  File "test_trainer_circle.py", line 28, in <module>
    unittest.main()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 101, in __init__
    self.runTests()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 271, in runTests
    self.result = testRunner.run(self.test)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/runner.py", line 176, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 676, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 628, in run
    testMethod()
  File "test_trainer_circle.py", line 24, in test_train_function
    trained_model = train(self.model, self.config, self.train_dataset, self.val_dataset)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/training/trainer.py", line 56, in train
    train_acc = calculate_accuracy(model, train_loader, config.training.device)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/training/training_utils.py", line 14, in calculate_accuracy
    for items in islice(data_loader, N // batch_size):
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 167, in __getitem__
    img = draw_circle_with_points(data_point[0], data_point[1], self.circle_metadata, model_type = self.model_type)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 112, in draw_circle_with_points
    img = transform(img)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 135, in __call__
    return F.to_tensor(pic)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/functional.py", line 162, in to_tensor
    mode_to_nptype = {"I": np.int32, "I;16": np.int16, "F": np.float32}
KeyboardInterrupt