
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=True, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.001, num_epochs=5, batch_size=64, warmup_steps=0, weight_decay=0.0, device='cuda', seed=0, optimizer_name='AdamW'), logging=LoggingConfig(log_dir='logs', log_frequency=10, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7f6e6370a0d0>)
  0%|                                                                                                                                                                                                                                                                           | 0/5 [00:00<?, ?it/s]
0it [00:00, ?it/s]

6it [00:08,  1.04s/it]
Steps10 | Train loss: 0.089 | Train acc: 0.017 | Test loss: 0.158 | Test acc: 0.000
 20%|███████████████████████████████████████████████████▊                                                                                                                                                                                                               | 1/5 [00:10<00:43, 10.98s/it]
0it [00:00, ?it/s]

18it [00:02,  8.80it/s]
Steps40 | Train loss: 0.069 | Train acc: 0.012 | Test loss: 0.120 | Test acc: 0.000
 40%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                           | 2/5 [00:14<00:20,  6.73s/it]
0it [00:00, ?it/s]

20it [00:02,  9.13it/s]
Steps70 | Train loss: 0.068 | Train acc: 0.015 | Test loss: 0.118 | Test acc: 0.000
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                       | 3/5 [00:18<00:10,  5.38s/it]
5it [00:00, 44.46it/s]

24it [00:02,  9.49it/s]
Steps100 | Train loss: 0.068 | Train acc: 0.017 | Test loss: 0.121 | Test acc: 0.000
 80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 4/5 [00:23<00:04,  4.74s/it]
10it [00:01,  6.89it/s]
Steps120 | Train loss: 0.069 | Train acc: 0.017 | Test loss: 0.127 | Test acc: 0.000

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:24<00:00,  4.99s/it]