
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.0005, num_epochs=50000, batch_size=1024, warmup_steps=10, weight_decay=0.0, device='cuda', seed=0, optimizer_name='AdamW'), logging=LoggingConfig(log_dir='logs', log_frequency=30, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7f1a38e903d0>)


  0%|                                                                                                                                                                                                                                                            | 3/50000 [00:07<27:04:00,  1.95s/it]





  0%|                                                                                                                                                                                                                                                           | 17/50000 [00:17<12:08:48,  1.14it/s]





  0%|▏                                                                                                                                                                                                                                                          | 31/50000 [00:27<13:20:24,  1.04it/s]





  0%|▏                                                                                                                                                                                                                                                          | 46/50000 [00:37<13:15:23,  1.05it/s]





  0%|▎                                                                                                                                                                                                                                                          | 61/50000 [00:47<13:11:40,  1.05it/s]





  0%|▍                                                                                                                                                                                                                                                           | 75/50000 [00:57<8:18:37,  1.67it/s]






  0%|▍                                                                                                                                                                                                                                                          | 92/50000 [01:15<11:49:23,  1.17it/s]





  0%|▌                                                                                                                                                                                                                                                         | 107/50000 [01:25<11:54:28,  1.16it/s]





  0%|▌                                                                                                                                                                                                                                                         | 121/50000 [01:35<13:23:44,  1.03it/s]





  0%|▋                                                                                                                                                                                                                                                         | 136/50000 [01:45<13:11:18,  1.05it/s]





  0%|▊                                                                                                                                                                                                                                                         | 151/50000 [01:55<13:09:59,  1.05it/s]





  0%|▊                                                                                                                                                                                                                                                         | 166/50000 [02:05<13:13:45,  1.05it/s]





  0%|▉                                                                                                                                                                                                                                                         | 181/50000 [02:16<13:15:28,  1.04it/s]





  0%|▉                                                                                                                                                                                                                                                          | 195/50000 [02:25<8:23:01,  1.65it/s]




  0%|█                                                                                                                                                                                                                                                          | 209/50000 [02:34<8:21:20,  1.66it/s]





  0%|█                                                                                                                                                                                                                                                          | 224/50000 [02:44<8:15:51,  1.67it/s]






  0%|█▏                                                                                                                                                                                                                                                         | 240/50000 [02:54<8:16:11,  1.67it/s]





  1%|█▎                                                                                                                                                                                                                                                         | 255/50000 [03:05<8:15:21,  1.67it/s]





  1%|█▎                                                                                                                                                                                                                                                         | 270/50000 [03:15<8:15:55,  1.67it/s]





  1%|█▍                                                                                                                                                                                                                                                         | 285/50000 [03:25<8:15:29,  1.67it/s]





  1%|█▌                                                                                                                                                                                                                                                         | 300/50000 [03:35<8:15:03,  1.67it/s]





  1%|█▌                                                                                                                                                                                                                                                         | 315/50000 [03:45<8:21:00,  1.65it/s]





  1%|█▋                                                                                                                                                                                                                                                         | 330/50000 [03:55<8:18:49,  1.66it/s]





  1%|█▋                                                                                                                                                                                                                                                         | 345/50000 [04:06<8:16:17,  1.67it/s]





  1%|█▊                                                                                                                                                                                                                                                         | 360/50000 [04:16<8:13:06,  1.68it/s]





  1%|█▉                                                                                                                                                                                                                                                         | 375/50000 [04:26<8:15:52,  1.67it/s]





  1%|█▉                                                                                                                                                                                                                                                         | 390/50000 [04:36<8:14:23,  1.67it/s]





  1%|██                                                                                                                                                                                                                                                         | 404/50000 [04:46<8:13:12,  1.68it/s]





  1%|██                                                                                                                                                                                                                                                         | 419/50000 [04:56<8:16:35,  1.66it/s]





  1%|██▏                                                                                                                                                                                                                                                        | 434/50000 [05:06<8:14:11,  1.67it/s]






  1%|██▎                                                                                                                                                                                                                                                        | 450/50000 [05:18<8:18:26,  1.66it/s]





  1%|██▎                                                                                                                                                                                                                                                        | 465/50000 [05:27<8:17:31,  1.66it/s]





  1%|██▍                                                                                                                                                                                                                                                        | 480/50000 [05:37<8:14:57,  1.67it/s]





  1%|██▍                                                                                                                                                                                                                                                        | 495/50000 [05:47<8:12:01,  1.68it/s]





  1%|██▌                                                                                                                                                                                                                                                        | 510/50000 [05:57<8:12:36,  1.67it/s]





  1%|██▋                                                                                                                                                                                                                                                        | 525/50000 [06:08<8:11:54,  1.68it/s]





  1%|██▋                                                                                                                                                                                                                                                        | 540/50000 [06:18<8:13:11,  1.67it/s]





  1%|██▊                                                                                                                                                                                                                                                        | 555/50000 [06:28<8:14:18,  1.67it/s]





  1%|██▊                                                                                                                                                                                                                                                        | 570/50000 [06:38<8:13:52,  1.67it/s]





  1%|██▉                                                                                                                                                                                                                                                        | 585/50000 [06:48<8:20:08,  1.65it/s]





  1%|███                                                                                                                                                                                                                                                        | 599/50000 [06:58<8:20:17,  1.65it/s]





  1%|███                                                                                                                                                                                                                                                        | 614/50000 [07:08<8:18:11,  1.65it/s]





  1%|███▏                                                                                                                                                                                                                                                       | 629/50000 [07:18<8:11:03,  1.68it/s]






  1%|███▏                                                                                                                                                                                                                                                       | 645/50000 [07:29<8:13:56,  1.67it/s]





  1%|███▎                                                                                                                                                                                                                                                       | 660/50000 [07:39<8:08:45,  1.68it/s]





  1%|███▍                                                                                                                                                                                                                                                       | 675/50000 [07:49<8:10:46,  1.68it/s]





  1%|███▍                                                                                                                                                                                                                                                       | 690/50000 [07:59<8:12:09,  1.67it/s]





  1%|███▌                                                                                                                                                                                                                                                       | 705/50000 [08:10<8:13:11,  1.67it/s]





  1%|███▌                                                                                                                                                                                                                                                       | 720/50000 [08:20<8:20:14,  1.64it/s]





  1%|███▋                                                                                                                                                                                                                                                       | 735/50000 [08:30<8:17:23,  1.65it/s]






  2%|███▊                                                                                                                                                                                                                                                      | 750/50000 [08:46<13:56:27,  1.02s/it]





  2%|███▊                                                                                                                                                                                                                                                       | 765/50000 [08:56<8:13:20,  1.66it/s]





  2%|███▉                                                                                                                                                                                                                                                       | 780/50000 [09:06<8:09:41,  1.68it/s]






  2%|███▉                                                                                                                                                                                                                                                      | 796/50000 [09:19<13:13:40,  1.03it/s]





  2%|████                                                                                                                                                                                                                                                      | 811/50000 [09:29<12:59:46,  1.05it/s]





  2%|████▏                                                                                                                                                                                                                                                     | 826/50000 [09:39<12:57:28,  1.05it/s]





  2%|████▏                                                                                                                                                                                                                                                     | 841/50000 [09:49<12:58:28,  1.05it/s]





  2%|████▎                                                                                                                                                                                                                                                      | 855/50000 [09:59<8:17:56,  1.64it/s]





  2%|████▎                                                                                                                                                                                                                                                      | 870/50000 [10:09<8:12:16,  1.66it/s]





  2%|████▍                                                                                                                                                                                                                                                      | 884/50000 [10:17<8:13:17,  1.66it/s]
Steps1770 | Train loss: 0.003 | Train acc: 0.290 | Test loss: 0.198 | Test acc: 0.000




  2%|████▌                                                                                                                                                                                                                                                      | 900/50000 [10:28<8:06:28,  1.68it/s]





  2%|████▌                                                                                                                                                                                                                                                      | 915/50000 [10:38<8:04:51,  1.69it/s]





  2%|████▋                                                                                                                                                                                                                                                      | 930/50000 [10:48<8:05:26,  1.68it/s]





  2%|████▋                                                                                                                                                                                                                                                      | 945/50000 [10:58<8:06:02,  1.68it/s]





  2%|████▊                                                                                                                                                                                                                                                      | 960/50000 [11:08<8:06:43,  1.68it/s]





  2%|████▉                                                                                                                                                                                                                                                      | 975/50000 [11:18<8:08:36,  1.67it/s]





  2%|████▉                                                                                                                                                                                                                                                      | 990/50000 [11:29<8:11:07,  1.66it/s]





  2%|█████                                                                                                                                                                                                                                                     | 1005/50000 [11:39<8:09:11,  1.67it/s]






  2%|█████                                                                                                                                                                                                                                                    | 1022/50000 [11:51<11:30:18,  1.18it/s]





  2%|█████▏                                                                                                                                                                                                                                                   | 1037/50000 [12:01<11:37:45,  1.17it/s]





  2%|█████▏                                                                                                                                                                                                                                                   | 1052/50000 [12:11<11:37:13,  1.17it/s]





  2%|█████▎                                                                                                                                                                                                                                                   | 1067/50000 [12:22<11:35:32,  1.17it/s]





  2%|█████▍                                                                                                                                                                                                                                                   | 1082/50000 [12:32<11:26:25,  1.19it/s]





  2%|█████▍                                                                                                                                                                                                                                                   | 1096/50000 [12:41<12:54:19,  1.05it/s]





  2%|█████▌                                                                                                                                                                                                                                                    | 1110/50000 [12:51<8:05:06,  1.68it/s]





  2%|█████▋                                                                                                                                                                                                                                                    | 1125/50000 [13:01<8:12:18,  1.65it/s]





  2%|█████▋                                                                                                                                                                                                                                                    | 1140/50000 [13:10<8:09:37,  1.66it/s]





  2%|█████▊                                                                                                                                                                                                                                                    | 1155/50000 [13:20<8:08:43,  1.67it/s]





  2%|█████▊                                                                                                                                                                                                                                                    | 1170/50000 [13:30<8:05:27,  1.68it/s]





  2%|█████▉                                                                                                                                                                                                                                                    | 1185/50000 [13:40<8:03:32,  1.68it/s]





  2%|██████                                                                                                                                                                                                                                                    | 1200/50000 [13:50<8:05:28,  1.68it/s]





  2%|██████                                                                                                                                                                                                                                                    | 1215/50000 [14:01<8:02:55,  1.68it/s]





  2%|██████▏                                                                                                                                                                                                                                                   | 1230/50000 [14:11<8:04:13,  1.68it/s]





  2%|██████▏                                                                                                                                                                                                                                                   | 1245/50000 [14:21<8:03:45,  1.68it/s]






  3%|██████▎                                                                                                                                                                                                                                                  | 1262/50000 [14:33<11:29:38,  1.18it/s]





  3%|██████▎                                                                                                                                                                                                                                                  | 1277/50000 [14:44<11:31:56,  1.17it/s]





  3%|██████▍                                                                                                                                                                                                                                                  | 1292/50000 [14:54<11:25:54,  1.18it/s]





  3%|██████▌                                                                                                                                                                                                                                                  | 1306/50000 [15:03<13:05:47,  1.03it/s]





  3%|██████▌                                                                                                                                                                                                                                                  | 1321/50000 [15:14<13:06:50,  1.03it/s]





  3%|██████▋                                                                                                                                                                                                                                                  | 1336/50000 [15:24<12:59:42,  1.04it/s]





  3%|██████▋                                                                                                                                                                                                                                                  | 1351/50000 [15:34<12:49:43,  1.05it/s]





  3%|██████▊                                                                                                                                                                                                                                                  | 1366/50000 [15:44<12:52:23,  1.05it/s]





  3%|██████▉                                                                                                                                                                                                                                                  | 1381/50000 [15:54<12:53:22,  1.05it/s]





  3%|██████▉                                                                                                                                                                                                                                                   | 1395/50000 [16:04<8:08:17,  1.66it/s]





  3%|███████                                                                                                                                                                                                                                                   | 1410/50000 [16:14<8:08:49,  1.66it/s]





  3%|███████▏                                                                                                                                                                                                                                                  | 1425/50000 [16:24<8:06:45,  1.66it/s]





  3%|███████▏                                                                                                                                                                                                                                                  | 1440/50000 [16:33<8:01:58,  1.68it/s]






  3%|███████▎                                                                                                                                                                                                                                                 | 1458/50000 [16:46<10:30:38,  1.28it/s]





  3%|███████▎                                                                                                                                                                                                                                                 | 1473/50000 [16:56<10:29:07,  1.29it/s]





  3%|███████▍                                                                                                                                                                                                                                                 | 1488/50000 [17:06<10:21:17,  1.30it/s]





  3%|███████▍                                                                                                                                                                                                                                                 | 1502/50000 [17:16<11:23:37,  1.18it/s]





  3%|███████▌                                                                                                                                                                                                                                                 | 1517/50000 [17:26<11:21:32,  1.19it/s]





  3%|███████▋                                                                                                                                                                                                                                                 | 1532/50000 [17:36<11:25:27,  1.18it/s]





  3%|███████▋                                                                                                                                                                                                                                                 | 1546/50000 [17:46<12:51:41,  1.05it/s]





  3%|███████▊                                                                                                                                                                                                                                                 | 1561/50000 [17:56<12:45:28,  1.05it/s]





  3%|███████▊                                                                                                                                                                                                                                                 | 1576/50000 [18:06<12:59:03,  1.04it/s]





  3%|███████▉                                                                                                                                                                                                                                                  | 1590/50000 [18:16<8:02:24,  1.67it/s]





  3%|████████                                                                                                                                                                                                                                                  | 1605/50000 [18:26<7:58:20,  1.69it/s]





  3%|████████                                                                                                                                                                                                                                                  | 1620/50000 [18:36<8:00:14,  1.68it/s]





  3%|████████▏                                                                                                                                                                                                                                                 | 1635/50000 [18:45<8:00:59,  1.68it/s]





  3%|████████▎                                                                                                                                                                                                                                                 | 1650/50000 [18:55<8:03:50,  1.67it/s]






  3%|████████▎                                                                                                                                                                                                                                                | 1668/50000 [19:08<10:24:13,  1.29it/s]





  3%|████████▍                                                                                                                                                                                                                                                | 1683/50000 [19:19<10:23:01,  1.29it/s]





  3%|████████▍                                                                                                                                                                                                                                                | 1697/50000 [19:28<11:21:37,  1.18it/s]





  3%|████████▌                                                                                                                                                                                                                                                | 1712/50000 [19:38<11:28:29,  1.17it/s]





  3%|████████▌                                                                                                                                                                                                                                                | 1727/50000 [19:48<11:27:08,  1.17it/s]





  3%|████████▋                                                                                                                                                                                                                                                | 1742/50000 [19:59<11:28:15,  1.17it/s]





  4%|████████▋                                                                                                                                                                                                                                                | 1757/50000 [20:09<11:18:57,  1.18it/s]





  4%|████████▊                                                                                                                                                                                                                                                | 1771/50000 [20:18<12:44:17,  1.05it/s]





  4%|████████▉                                                                                                                                                                                                                                                | 1786/50000 [20:28<12:43:58,  1.05it/s]





  4%|████████▉                                                                                                                                                                                                                                                | 1801/50000 [20:39<12:48:21,  1.05it/s]





  4%|█████████                                                                                                                                                                                                                                                | 1816/50000 [20:49<12:45:07,  1.05it/s]





  4%|█████████                                                                                                                                                                                                                                                | 1831/50000 [20:59<12:45:33,  1.05it/s]





  4%|█████████▏                                                                                                                                                                                                                                               | 1846/50000 [21:09<12:55:39,  1.03it/s]





  4%|█████████▎                                                                                                                                                                                                                                                | 1860/50000 [21:19<7:55:39,  1.69it/s]





  4%|█████████▍                                                                                                                                                                                                                                                | 1875/50000 [21:29<7:58:19,  1.68it/s]






  4%|█████████▍                                                                                                                                                                                                                                                | 1894/50000 [21:41<9:32:10,  1.40it/s]





  4%|█████████▌                                                                                                                                                                                                                                               | 1908/50000 [21:51<10:15:00,  1.30it/s]





  4%|█████████▌                                                                                                                                                                                                                                               | 1923/50000 [22:01<10:15:49,  1.30it/s]


  4%|█████████▋                                                                                                                                                                                                                                                | 1930/50000 [22:05<9:10:26,  1.46it/s]
Traceback (most recent call last):
  File "test_trainer_circle.py", line 28, in <module>
    unittest.main()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 101, in __init__
    self.runTests()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 271, in runTests
    self.result = testRunner.run(self.test)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/runner.py", line 176, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 676, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 628, in run
    testMethod()
  File "test_trainer_circle.py", line 24, in test_train_function
    trained_model = train(self.model, self.config, self.train_dataset, self.val_dataset)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/training/trainer.py", line 51, in train
    set_seed(config.training.seed)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 167, in __getitem__
    img = draw_circle_with_points(data_point[0], data_point[1], self.circle_metadata, model_type = self.model_type)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 112, in draw_circle_with_points
    img = transform(img)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 135, in __call__
    return F.to_tensor(pic)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/functional.py", line 167, in to_tensor
    img = img.view(pic.size[1], pic.size[0], len(pic.getbands()))
KeyboardInterrupt