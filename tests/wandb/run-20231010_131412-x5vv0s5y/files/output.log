
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.0005, num_epochs=50000, batch_size=256, warmup_steps=10, weight_decay=0.0, device='cuda', seed=0, optimizer_name='AdamW'), logging=LoggingConfig(log_dir='logs', log_frequency=10, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7fc3adfefe50>)

  0%|                                                                                                                                                                                                                                                                       | 0/50000 [00:05<?, ?it/s]


  0%|                                                                                                                                                                                                                                                            | 2/50000 [00:08<53:30:51,  3.85s/it]

  0%|                                                                                                                                                                                                                                                            | 4/50000 [00:11<28:28:17,  2.05s/it]

  0%|                                                                                                                                                                                                                                                            | 5/50000 [00:12<27:36:25,  1.99s/it]

  0%|                                                                                                                                                                                                                                                            | 7/50000 [00:15<21:16:01,  1.53s/it]

  0%|                                                                                                                                                                                                                                                            | 8/50000 [00:17<22:48:45,  1.64s/it]

  0%|                                                                                                                                                                                                                                                           | 10/50000 [00:19<19:20:01,  1.39s/it]

  0%|                                                                                                                                                                                                                                                           | 11/50000 [00:21<21:23:15,  1.54s/it]

  0%|                                                                                                                                                                                                                                                           | 12/50000 [00:23<22:44:02,  1.64s/it]

  0%|                                                                                                                                                                                                                                                           | 13/50000 [00:25<23:43:08,  1.71s/it]

  0%|                                                                                                                                                                                                                                                           | 15/50000 [00:28<21:20:29,  1.54s/it]

  0%|                                                                                                                                                                                                                                                           | 16/50000 [00:29<22:46:08,  1.64s/it]

  0%|                                                                                                                                                                                                                                                           | 17/50000 [00:31<18:42:10,  1.35s/it]

  0%|                                                                                                                                                                                                                                                           | 18/50000 [00:32<20:49:48,  1.50s/it]


  0%|                                                                                                                                                                                                                                                           | 21/50000 [00:36<20:43:05,  1.49s/it]

  0%|                                                                                                                                                                                                                                                           | 22/50000 [00:38<22:15:35,  1.60s/it]

  0%|                                                                                                                                                                                                                                                           | 24/50000 [00:41<19:09:22,  1.38s/it]

  0%|▏                                                                                                                                                                                                                                                          | 25/50000 [00:43<21:09:50,  1.52s/it]

  0%|▏                                                                                                                                                                                                                                                          | 27/50000 [00:45<18:33:03,  1.34s/it]

  0%|▏                                                                                                                                                                                                                                                          | 28/50000 [00:47<20:42:45,  1.49s/it]

  0%|▏                                                                                                                                                                                                                                                          | 30/50000 [00:50<18:19:17,  1.32s/it]

  0%|▏                                                                                                                                                                                                                                                          | 31/50000 [00:51<20:33:05,  1.48s/it]

  0%|▏                                                                                                                                                                                                                                                          | 32/50000 [00:53<22:05:58,  1.59s/it]

  0%|▏                                                                                                                                                                                                                                                          | 33/50000 [00:55<23:30:48,  1.69s/it]

  0%|▏                                                                                                                                                                                                                                                          | 34/50000 [00:57<19:14:32,  1.39s/it]

  0%|▏                                                                                                                                                                                                                                                          | 36/50000 [01:00<22:33:31,  1.63s/it]

  0%|▏                                                                                                                                                                                                                                                          | 37/50000 [01:02<18:35:42,  1.34s/it]

  0%|▏                                                                                                                                                                                                                                                          | 38/50000 [01:02<20:44:15,  1.49s/it]
  0%|▏                                                                                                                                                                                                                                                          | 39/50000 [01:05<23:08:52,  1.67s/it]
Traceback (most recent call last):
  File "test_trainer_circle.py", line 28, in <module>
    unittest.main()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 101, in __init__
    self.runTests()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 271, in runTests
    self.result = testRunner.run(self.test)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/runner.py", line 176, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 676, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 628, in run
    testMethod()
  File "test_trainer_circle.py", line 24, in test_train_function
    trained_model = train(self.model, self.config, self.train_dataset, self.val_dataset)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/training/trainer.py", line 51, in train
    for idx, items in enumerate(train_loader):
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 167, in __getitem__
    img = draw_circle_with_points(data_point[0], data_point[1], self.circle_metadata, model_type = self.model_type)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 109, in draw_circle_with_points
    transforms.Normalize(mean, std)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 258, in __init__
    self.mean = mean
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1317, in __setattr__
    super().__setattr__(name, value)
KeyboardInterrupt