
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.0005, num_epochs=50000, batch_size=-1, warmup_steps=10, weight_decay=0.1, device='cuda', seed=0, optimizer_name='AdamW', scheduler_step=1000, scheduler_gamma=0.5), logging=LoggingConfig(log_dir='logs', log_frequency=30, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7f630b0884d0>)
Length of trainloader 1
Length of testloader 1
  0%|                                                                                                                                                                                                                                                                       | 0/50000 [00:00<?, ?it/s]










  0%|▏                                                                                                                                                                                                                                                          | 32/50000 [00:25<11:31:05,  1.21it/s]









  0%|▎                                                                                                                                                                                                                                                          | 61/50000 [00:43<13:07:34,  1.06it/s]









  0%|▍                                                                                                                                                                                                                                                           | 90/50000 [01:00<8:03:49,  1.72it/s]










  0%|▌                                                                                                                                                                                                                                                         | 122/50000 [01:21<11:26:37,  1.21it/s]









  0%|▊                                                                                                                                                                                                                                                         | 151/50000 [01:39<13:03:18,  1.06it/s]









  0%|▉                                                                                                                                                                                                                                                         | 181/50000 [01:57<12:57:44,  1.07it/s]










  0%|█                                                                                                                                                                                                                                                         | 213/50000 [02:17<10:29:28,  1.32it/s]









  0%|█▏                                                                                                                                                                                                                                                        | 242/50000 [02:35<11:25:59,  1.21it/s]









  1%|█▎                                                                                                                                                                                                                                                        | 271/50000 [02:53<12:51:59,  1.07it/s]










  1%|█▌                                                                                                                                                                                                                                                         | 304/50000 [03:14<9:38:05,  1.43it/s]









  1%|█▋                                                                                                                                                                                                                                                        | 333/50000 [03:32<10:19:44,  1.34it/s]









  1%|█▊                                                                                                                                                                                                                                                        | 362/50000 [03:50<11:30:35,  1.20it/s]









  1%|█▉                                                                                                                                                                                                                                                        | 391/50000 [04:08<12:53:19,  1.07it/s]










  1%|██▏                                                                                                                                                                                                                                                        | 424/50000 [04:28<9:41:08,  1.42it/s]









  1%|██▎                                                                                                                                                                                                                                                       | 453/50000 [04:46<10:18:25,  1.34it/s]








  1%|██▍                                                                                                                                                                                                                                                        | 480/50000 [05:01<7:54:49,  1.74it/s]









  1%|██▌                                                                                                                                                                                                                                                        | 510/50000 [05:20<8:05:28,  1.70it/s]










  1%|██▋                                                                                                                                                                                                                                                       | 541/50000 [05:40<12:50:55,  1.07it/s]









  1%|██▊                                                                                                                                                                                                                                                        | 570/50000 [05:57<7:52:24,  1.74it/s]









  1%|███                                                                                                                                                                                                                                                        | 600/50000 [06:16<7:57:20,  1.72it/s]









  1%|███▏                                                                                                                                                                                                                                                       | 629/50000 [06:34<7:54:31,  1.73it/s]










  1%|███▎                                                                                                                                                                                                                                                       | 660/50000 [06:53<8:00:47,  1.71it/s]









  1%|███▍                                                                                                                                                                                                                                                       | 690/50000 [07:12<7:54:28,  1.73it/s]









  1%|███▌                                                                                                                                                                                                                                                       | 720/50000 [07:30<7:53:26,  1.73it/s]










  2%|███▊                                                                                                                                                                                                                                                      | 751/50000 [07:51<12:46:57,  1.07it/s]









  2%|███▉                                                                                                                                                                                                                                                       | 780/50000 [08:07<7:50:26,  1.74it/s]









  2%|████                                                                                                                                                                                                                                                       | 810/50000 [08:26<7:57:39,  1.72it/s]









  2%|████▏                                                                                                                                                                                                                                                      | 840/50000 [08:44<7:50:16,  1.74it/s]










  2%|████▎                                                                                                                                                                                                                                                     | 871/50000 [09:05<12:53:49,  1.06it/s]









  2%|████▌                                                                                                                                                                                                                                                      | 900/50000 [09:22<7:50:06,  1.74it/s]









  2%|████▋                                                                                                                                                                                                                                                      | 930/50000 [09:40<7:50:51,  1.74it/s]










  2%|████▊                                                                                                                                                                                                                                                     | 961/50000 [10:01<12:49:13,  1.06it/s]









  2%|████▉                                                                                                                                                                                                                                                     | 991/50000 [10:19<12:40:57,  1.07it/s]









  2%|█████                                                                                                                                                                                                                                                     | 1020/50000 [10:36<8:00:04,  1.70it/s]









  2%|█████▎                                                                                                                                                                                                                                                    | 1050/50000 [10:55<7:51:08,  1.73it/s]










  2%|█████▍                                                                                                                                                                                                                                                   | 1081/50000 [11:15<12:56:25,  1.05it/s]









  2%|█████▌                                                                                                                                                                                                                                                    | 1110/50000 [11:34<7:52:12,  1.73it/s]






  2%|█████▋                                                                                                                                                                                                                                                    | 1132/50000 [11:46<8:28:24,  1.60it/s]
Traceback (most recent call last):
  File "test_trainer_circle.py", line 28, in <module>
    unittest.main()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 101, in __init__
    self.runTests()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 271, in runTests
    self.result = testRunner.run(self.test)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/runner.py", line 176, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 676, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 628, in run
    testMethod()
  File "test_trainer_circle.py", line 24, in test_train_function
    trained_model = train(self.model, self.config, self.train_dataset, self.val_dataset)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/training/trainer.py", line 77, in train
    for epoch in tqdm(range(1, config.training.num_epochs + 1)):
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 167, in __getitem__
    img = draw_circle_with_points(data_point[0], data_point[1], self.circle_metadata, model_type = self.model_type)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 72, in draw_circle_with_points
    y = center[1] + radius * math.sin(math.radians(i))
KeyboardInterrupt