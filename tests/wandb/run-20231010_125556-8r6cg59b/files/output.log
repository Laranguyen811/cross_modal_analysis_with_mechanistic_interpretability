
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.001, num_epochs=100, batch_size=64, warmup_steps=10, weight_decay=0.0, device='cuda', seed=0, optimizer_name='AdamW'), logging=LoggingConfig(log_dir='logs', log_frequency=10, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7f2f2df00550>)
  0%|                                                                                                                                                                                                                                                                         | 0/100 [00:00<?, ?it/s]
0it [00:00, ?it/s]

9it [00:06,  2.13it/s]
  1%|██▌                                                                                                                                                                                                                                                              | 1/100 [00:09<15:35,  9.45s/it]
0it [00:00, ?it/s]

12it [00:01, 12.02it/s]
Steps30 | Train loss: 3.661 | Train acc: 0.015 | Test loss: 7.331 | Test acc: 0.000
  2%|█████▏                                                                                                                                                                                                                                                           | 2/100 [00:13<10:04,  6.17s/it]
4it [00:00, 39.97it/s]

13it [00:01,  9.79it/s]
Steps60 | Train loss: 4.066 | Train acc: 0.016 | Test loss: 6.870 | Test acc: 0.028
  3%|███████▋                                                                                                                                                                                                                                                         | 3/100 [00:17<08:17,  5.13s/it]
5it [00:00, 40.56it/s]

15it [00:01, 10.85it/s]
Steps90 | Train loss: 10.012 | Train acc: 0.017 | Test loss: 20.421 | Test acc: 0.000
  4%|██████████▎                                                                                                                                                                                                                                                      | 4/100 [00:21<07:24,  4.63s/it]
4it [00:00, 39.84it/s]
Steps110 | Train loss: 10.695 | Train acc: 0.016 | Test loss: 15.498 | Test acc: 0.028

17it [00:01, 13.39it/s]
  5%|████████████▊                                                                                                                                                                                                                                                    | 5/100 [00:24<06:18,  3.98s/it]
10it [00:01, 11.14it/s]
Steps140 | Train loss: 12.800 | Train acc: 0.016 | Test loss: 19.601 | Test acc: 0.028

19it [00:02,  9.09it/s]
  6%|███████████████▍                                                                                                                                                                                                                                                 | 6/100 [00:28<06:10,  3.94s/it]
11it [00:01, 11.29it/s]
Steps170 | Train loss: 4.473 | Train acc: 0.016 | Test loss: 8.094 | Test acc: 0.028

19it [00:03,  8.44it/s]
  7%|█████████████████▉                                                                                                                                                                                                                                               | 7/100 [00:32<06:05,  3.93s/it]
10it [00:01,  8.92it/s]
Steps200 | Train loss: 19.647 | Train acc: 0.016 | Test loss: 32.360 | Test acc: 0.028

20it [00:03,  8.92it/s]
8it [00:01,  6.29it/s]███▌                                                                                                                                                                                                                                            | 8/100 [00:37<06:11,  4.03s/it]
  8%|████████████████████▌                                                                                                                                                                                                                                            | 8/100 [00:37<07:07,  4.65s/it]
Traceback (most recent call last):
  File "test_trainer_circle.py", line 28, in <module>
    unittest.main()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 101, in __init__
    self.runTests()
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/main.py", line 271, in runTests
    self.result = testRunner.run(self.test)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/runner.py", line 176, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 84, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/suite.py", line 122, in run
    test(result)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 676, in __call__
    return self.run(*args, **kwds)
  File "/cvmfs/ai.mila.quebec/apps/x86_64/debian/anaconda/3/lib/python3.7/unittest/case.py", line 628, in run
    testMethod()
  File "test_trainer_circle.py", line 24, in test_train_function
    trained_model = train(self.model, self.config, self.train_dataset, self.val_dataset)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/training/trainer.py", line 51, in train
    for idx, items in tqdm(enumerate(train_loader)):
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/tqdm/std.py", line 1182, in __iter__
    for obj in iterable:
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 671, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/env/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 58, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 167, in __getitem__
    img = draw_circle_with_points(data_point[0], data_point[1], self.circle_metadata, model_type = self.model_type)
  File "/home/mila/s/sonia.joseph/ViT-Planetarium/src/vit_planetarium/dataloaders/circle.py", line 71, in draw_circle_with_points
    x = center[0] + radius * math.cos(math.radians(i))
KeyboardInterrupt
Steps230 | Train loss: 19.990 | Train acc: 0.016 | Test loss: 35.065 | Test acc: 0.000