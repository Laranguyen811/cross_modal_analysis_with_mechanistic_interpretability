
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=7, n_channels=1), transformer=TransformerConfig(hidden_dim=128, num_heads=4, num_layers=4, mlp_dim=512, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.0008, num_epochs=100, batch_size=256, warmup_steps=10, weight_decay=0.0, device='cuda', seed=0, optimizer_name='AdamW'), logging=LoggingConfig(log_dir='logs', log_frequency=10, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7f09fd1a6310>)
  0%|                                                                                                                                                                                                                                                                         | 0/100 [00:00<?, ?it/s]
0it [00:00, ?it/s]

  1%|██▌                                                                                                                                                                                                                                                              | 1/100 [00:06<10:27,  6.34s/it]
2it [00:00, 13.32it/s]
Steps10 | Train loss: 0.459 | Train acc: 0.016 | Test loss: 3.304 | Test acc: 0.028
7it [00:01,  4.66it/s]                                                                                                                                                                                                                                                | 2/100 [00:09<05:42,  3.49s/it]
  3%|███████▋                                                                                                                                                                                                                                                         | 3/100 [00:09<04:10,  2.58s/it]
2it [00:00, 13.33it/s]
7it [00:01,  4.67it/s]                                                                                                                                                                                                                                                | 4/100 [00:11<02:49,  1.77s/it]
  5%|████████████▊                                                                                                                                                                                                                                                    | 5/100 [00:11<02:38,  1.67s/it]
2it [00:00, 13.39it/s]
7it [00:00, 13.76it/s]                                                                                                                                                                                                                                                | 6/100 [00:12<02:31,  1.61s/it]
  7%|█████████████████▉                                                                                                                                                                                                                                               | 7/100 [00:13<01:56,  1.25s/it]
0it [00:00, ?it/s]
  8%|████████████████████▌                                                                                                                                                                                                                                            | 8/100 [00:14<02:02,  1.33s/it]
4it [00:00, 13.18it/s]
7it [00:00, 13.54it/s]██████▏                                                                                                                                                                                                                                         | 9/100 [00:16<02:06,  1.39s/it]
 10%|█████████████████████████▌                                                                                                                                                                                                                                      | 10/100 [00:16<01:40,  1.12s/it]
0it [00:00, ?it/s]
 11%|████████████████████████████▏                                                                                                                                                                                                                                   | 11/100 [00:18<01:50,  1.24s/it]
2it [00:00, 13.23it/s]
7it [00:01,  4.61it/s]█████████████▋                                                                                                                                                                                                                                 | 12/100 [00:21<01:56,  1.33s/it]
 13%|█████████████████████████████████▎                                                                                                                                                                                                                              | 13/100 [00:21<02:00,  1.38s/it]
0it [00:00, ?it/s]
Steps90 | Train loss: 0.078 | Train acc: 0.018 | Test loss: 0.562 | Test acc: 0.028
7it [00:01,  4.61it/s]██████████████████▊                                                                                                                                                                                                                            | 14/100 [00:23<01:36,  1.12s/it]
 15%|██████████████████████████████████████▍                                                                                                                                                                                                                         | 15/100 [00:23<01:45,  1.24s/it]
0it [00:00, ?it/s]
7it [00:00, 13.59it/s]███████████████████████▉                                                                                                                                                                                                                       | 16/100 [00:25<01:51,  1.32s/it]
 17%|███████████████████████████████████████████▌                                                                                                                                                                                                                    | 17/100 [00:25<01:29,  1.08s/it]
0it [00:00, ?it/s]
 18%|██████████████████████████████████████████████                                                                                                                                                                                                                  | 18/100 [00:27<01:39,  1.21s/it]
4it [00:00, 13.16it/s]
7it [00:00, 13.56it/s]███████████████████████████████▋                                                                                                                                                                                                               | 19/100 [00:28<01:45,  1.31s/it]
 20%|███████████████████████████████████████████████████▏                                                                                                                                                                                                            | 20/100 [00:29<01:25,  1.07s/it]
0it [00:00, ?it/s]
 21%|█████████████████████████████████████████████████████▊                                                                                                                                                                                                          | 21/100 [00:30<01:35,  1.20s/it]
2it [00:00, 13.25it/s]
 22%|████████████████████████████████████████████████████████▎                                                                                                                                                                                                       | 22/100 [00:32<01:41,  1.30s/it]
6it [00:00, 13.22it/s]
Steps160 | Train loss: 0.026 | Train acc: 0.022 | Test loss: 0.218 | Test acc: 0.028
7it [00:00, 13.62it/s]█████████████████████████████████████████▉                                                                                                                                                                                                     | 23/100 [00:33<01:44,  1.36s/it]
 24%|█████████████████████████████████████████████████████████████▍                                                                                                                                                                                                  | 24/100 [00:35<01:24,  1.11s/it]
4it [00:01,  2.70it/s]
7it [00:01,  4.62it/s]███████████████████████████████████████████████                                                                                                                                                                                                | 25/100 [00:37<01:32,  1.23s/it]
 26%|██████████████████████████████████████████████████████████████████▌                                                                                                                                                                                             | 26/100 [00:37<01:37,  1.32s/it]
4it [00:00, 13.23it/s]
7it [00:01,  4.62it/s]████████████████████████████████████████████████████                                                                                                                                                                                           | 27/100 [00:38<01:18,  1.08s/it]
 28%|███████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                        | 28/100 [00:39<01:26,  1.21s/it]
4it [00:00, 13.17it/s]
7it [00:00, 13.71it/s]█████████████████████████████████████████████████████████▏                                                                                                                                                                                     | 29/100 [00:40<01:32,  1.30s/it]
 30%|████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                   | 30/100 [00:41<01:14,  1.06s/it]
0it [00:00, ?it/s]
 31%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                | 31/100 [00:42<01:22,  1.20s/it]
2it [00:00, 13.33it/s]
 32%|█████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                                              | 32/100 [00:44<01:28,  1.30s/it]
6it [00:00, 13.34it/s]
7it [00:00, 13.60it/s]███████████████████████████████████████████████████████████████████▍                                                                                                                                                                           | 33/100 [00:45<01:31,  1.36s/it]
 34%|███████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                         | 34/100 [00:47<01:13,  1.11s/it]
4it [00:01,  2.70it/s]
Steps240 | Train loss: 0.024 | Train acc: 0.018 | Test loss: 0.205 | Test acc: 0.000
7it [00:01,  4.61it/s]████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                      | 35/100 [00:49<01:20,  1.23s/it]
 36%|████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                                   | 36/100 [00:49<01:24,  1.32s/it]
2it [00:00, 13.29it/s]
7it [00:01,  4.67it/s]█████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                 | 37/100 [00:50<01:07,  1.07s/it]
 38%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                              | 38/100 [00:51<01:14,  1.20s/it]
2it [00:00, 13.36it/s]
7it [00:00, 13.76it/s]██████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                            | 39/100 [00:52<01:18,  1.29s/it]
 40%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                         | 40/100 [00:53<01:03,  1.06s/it]
0it [00:00, ?it/s]
 41%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                       | 41/100 [00:54<01:10,  1.19s/it]
2it [00:00, 13.22it/s]
 42%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                    | 42/100 [00:56<01:14,  1.29s/it]
6it [00:00, 13.22it/s]
7it [00:00, 13.55it/s]█████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                  | 43/100 [00:57<01:17,  1.36s/it]
 44%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                               | 44/100 [00:59<01:01,  1.10s/it]
2it [00:01, 13.23it/s]
Steps310 | Train loss: 0.021 | Train acc: 0.029 | Test loss: 0.187 | Test acc: 0.000
7it [00:01,  4.62it/s]██████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                            | 45/100 [01:01<01:07,  1.23s/it]
 46%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                          | 46/100 [01:01<01:10,  1.31s/it]
2it [00:00, 13.33it/s]
7it [00:01,  4.66it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                       | 47/100 [01:03<00:56,  1.07s/it]
 48%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                     | 48/100 [01:03<01:02,  1.20s/it]
2it [00:00, 13.29it/s]
7it [00:00, 13.50it/s]████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                  | 49/100 [01:04<01:05,  1.29s/it]
 50%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                | 50/100 [01:05<00:53,  1.06s/it]
0it [00:00, ?it/s]
 51%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                             | 51/100 [01:07<00:58,  1.20s/it]
2it [00:00, 13.23it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                           | 52/100 [01:08<01:02,  1.29s/it]
6it [00:00, 13.33it/s]
7it [00:00, 13.70it/s]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                        | 53/100 [01:10<01:03,  1.36s/it]
 54%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                     | 54/100 [01:10<00:50,  1.10s/it]
2it [00:00, 13.32it/s]
7it [00:01,  4.64it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                   | 55/100 [01:13<00:55,  1.22s/it]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 56/100 [01:13<00:57,  1.31s/it]
2it [00:00, 13.37it/s]
7it [00:01,  4.66it/s]████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                              | 57/100 [01:15<00:45,  1.07s/it]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                           | 58/100 [01:15<00:50,  1.20s/it]
2it [00:00, 13.39it/s]
Steps400 | Train loss: 0.019 | Train acc: 0.028 | Test loss: 0.182 | Test acc: 0.000
7it [00:00, 13.68it/s]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                         | 59/100 [01:17<00:52,  1.29s/it]
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                      | 60/100 [01:17<00:42,  1.06s/it]
0it [00:00, ?it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 61/100 [01:19<00:46,  1.19s/it]
2it [00:00, 13.29it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                 | 62/100 [01:20<00:48,  1.28s/it]
6it [00:00, 13.31it/s]
7it [00:00, 13.57it/s]████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                              | 63/100 [01:22<00:50,  1.37s/it]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                            | 64/100 [01:22<00:39,  1.11s/it]
2it [00:00, 13.24it/s]
7it [00:01,  4.63it/s]█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                         | 65/100 [01:25<00:43,  1.23s/it]
 66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                       | 66/100 [01:25<00:44,  1.32s/it]
0it [00:00, ?it/s]
7it [00:01,  4.67it/s]██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                    | 67/100 [01:27<00:35,  1.07s/it]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                  | 68/100 [01:27<00:38,  1.20s/it]
0it [00:00, ?it/s]
7it [00:00, 13.74it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 69/100 [01:29<00:40,  1.29s/it]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                            | 70/100 [01:29<00:31,  1.06s/it]
0it [00:00, ?it/s]
Steps480 | Train loss: 0.018 | Train acc: 0.033 | Test loss: 0.168 | Test acc: 0.000
 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                          | 71/100 [01:31<00:34,  1.19s/it]
2it [00:00, 13.35it/s]
 72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                       | 72/100 [01:32<00:35,  1.28s/it]
6it [00:00, 13.29it/s]
7it [00:00, 13.53it/s]█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                     | 73/100 [01:34<00:36,  1.35s/it]
 74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                  | 74/100 [01:34<00:28,  1.10s/it]
2it [00:00, 13.27it/s]
7it [00:01,  4.61it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                | 75/100 [01:37<00:30,  1.23s/it]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                             | 76/100 [01:37<00:31,  1.31s/it]
0it [00:00, ?it/s]
7it [00:01,  4.63it/s]████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                           | 77/100 [01:39<00:24,  1.07s/it]
 78%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 78/100 [01:39<00:26,  1.21s/it]
0it [00:00, ?it/s]
7it [00:00, 13.71it/s]█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 79/100 [01:41<00:27,  1.29s/it]
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                   | 80/100 [01:41<00:21,  1.06s/it]
0it [00:00, ?it/s]
Steps550 | Train loss: 0.018 | Train acc: 0.042 | Test loss: 0.169 | Test acc: 0.000
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 81/100 [01:43<00:22,  1.19s/it]
2it [00:00, 13.34it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 82/100 [01:44<00:23,  1.29s/it]
6it [00:00, 13.28it/s]
7it [00:00, 13.66it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                           | 83/100 [01:46<00:22,  1.35s/it]
 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 84/100 [01:46<00:17,  1.10s/it]
2it [00:00, 13.32it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                      | 85/100 [01:49<00:18,  1.22s/it]
6it [00:01,  3.31it/s]
7it [00:00, 13.69it/s]███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                   | 86/100 [01:49<00:18,  1.31s/it]
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 87/100 [01:51<00:13,  1.07s/it]
6it [00:01,  5.37it/s]
7it [00:01,  4.65it/s]████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              | 88/100 [01:53<00:14,  1.20s/it]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                            | 89/100 [01:53<00:14,  1.29s/it]
6it [00:00, 13.32it/s]
Steps620 | Train loss: 0.018 | Train acc: 0.048 | Test loss: 0.172 | Test acc: 0.000
7it [00:01,  4.65it/s]█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 90/100 [01:54<00:10,  1.06s/it]
 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 91/100 [01:55<00:10,  1.19s/it]
2it [00:00, 13.34it/s]
 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 92/100 [01:56<00:10,  1.28s/it]
6it [00:00, 13.24it/s]
7it [00:00, 13.69it/s]█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                  | 93/100 [01:58<00:09,  1.35s/it]
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋               | 94/100 [01:58<00:06,  1.10s/it]
2it [00:00, 13.36it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 95/100 [02:00<00:06,  1.24s/it]
4it [00:00, 13.29it/s]
7it [00:00, 13.66it/s]████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 96/100 [02:01<00:05,  1.32s/it]
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 97/100 [02:03<00:03,  1.08s/it]
4it [00:01,  3.57it/s]
7it [00:01,  4.66it/s]█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 98/100 [02:05<00:02,  1.20s/it]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 99/100 [02:05<00:01,  1.29s/it]
4it [00:00, 13.18it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [02:05<00:00,  1.26s/it]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [02:05<00:00,  1.26s/it]