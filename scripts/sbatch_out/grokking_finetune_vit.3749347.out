Loading circle dataset from cache... /home/mila/s/sonia.joseph/ViT-Planetarium/data/circle/train.npz
Loading circle dataset from cache... /home/mila/s/sonia.joseph/ViT-Planetarium/data/circle/test.npz
Config is: GlobalConfig(image=ImageConfig(image_size=32, patch_size=4, n_channels=1), transformer=TransformerConfig(hidden_dim=512, num_heads=4, num_layers=4, mlp_dim=2048, activation_name='GELU', attention_only=False, attn_hidden_layer=True), layernorm=LayerNormConfig(qknorm=False, layer_norm_eps=0.0), dropout=DropoutConfig(patch=0.0, position=0.0, attention=0.0, proj=0.0, mlp=0.0), init=InitializationConfig(weight_type='he', cls_std=1e-06, pos_std=0.02), training=TrainingConfig(loss_fn_name='CrossEntropy', lr=0.001, num_epochs=50000, batch_size=64, warmup_steps=10, weight_decay=0.01, device='cuda', seed=0, optimizer_name='AdamW', scheduler_step=50, scheduler_gamma=0.8), logging=LoggingConfig(log_dir='logs', log_frequency=12, print_every=0, use_wandb=True), saving=SavingConfig(parent_dir='/network/scratch/s/sonia.joseph/vit_planetarium', save_dir='checkpoints', save_checkpoints=True, save_cp_frequency=10), classification=<vit_planetarium.configs.CircleConfig.ClassificationConfig object at 0x7ff3adab5f10>)
Length of trainloader 28.
Length of testloader 1

======== GPU REPORT ========

==============NVSMI LOG==============

Timestamp                                 : Wed Oct 18 09:46:28 2023
Driver Version                            : 535.86.10
CUDA Version                              : 12.2

Attached GPUs                             : 1
GPU 00000000:01:00.0
    Accounting Mode                       : Disabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes                   : None

Wed Oct 18 09:46:28 2023       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.86.10              Driver Version: 535.86.10    CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  | 00000000:01:00.0 Off |                   On |
| N/A   56C    P0             327W / 500W |  52821MiB / 81920MiB |     N/A      Default |
|                                         |                      |              Enabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| MIG devices:                                                                          |
+------------------+--------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                   Memory-Usage |        Vol|      Shared           |
|      ID  ID  Dev |                     BAR1-Usage | SM     Unc| CE ENC DEC OFA JPG    |
|                  |                                |        ECC|                       |
|==================+================================+===========+=======================|
|  0    6   0   0  |            1517MiB / 19968MiB  | 28      0 |  2   0    1    0    0 |
|                  |               2MiB / 32767MiB  |           |                       |
+------------------+--------------------------------+-----------+-----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0    6    0      60563      C   python                                     1502MiB |
+---------------------------------------------------------------------------------------+
